<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8"> 
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
	<title>Smile - Carte de voeux 2015</title>
	
	<link rel="stylesheet" href="css/style.css" type="text/css">

    <script type="text/javascript" src="js/greensock/TweenMax.min.js"></script>
    <script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="js/jquery.superscrollorama.js"></script>
    <script type="text/javascript" src="js/modernizr.js"></script>
</head>

<body>
    <div class="perspective">
        <div class="container--3d">
            <div class="full-screen step_1 cf">
                <img src="images/logo-smile.png" class="logo-smile" alt="Logo Smile"/>
                <div class="container cf">
                    <p class="el1">Avec</p>
                    <p class="el2">l'open source,</p>
                    <p class="el3">vous n'avez encore</p>
                    <p class="el4">rien vu...</p>
                </div>
            </div>
            <div class="full-screen step_2 cf">
                <div class="volet volet-1">
                    <div class="volet-1__container">
                        <span class="year">En 2015</span>
                        <span class="accolade">{</span>
                    </div>
                </div>
                <img src="images/step2.png" alt="Meilleurs voeux Smile" class="step_2__main-img"/>
                <div class="volet volet-2"><span class="accolade">}</span></div>
            </div>
            <div class="full-screen step_3 cf">
                <div class="container cf">
                    <p class="el1">Meilleurs</p>
                    <p class="el2">voeux</p>
                    <p class="el3">et à bientôt sur <a href="http://www.smile.fr" target="_blank" title="Voir le site de Smile">www.smile.fr</a></p>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        jQuery(function($){
            TweenMax.selector = jQuery;

            var step1Anim = TweenMax
                    .fromTo('.step_1 .container',.7, {scale: "0.1", autoAlpha: "0"}, {scale: "1", autoAlpha: "1", ease: "easeInExpo", paused: true});


            // Issue on IE8 with vh unit
            var logoAnim = TweenMax
                    .fromTo('.logo-smile',
                        .5,
                        {css: {top: "-15vh"}},
                        {css: {top: "0vh"}, ease: "easeInExpo", paused: true, onComplete: function(){step1Anim.resume()}});


            var BackgroundApparition = TweenMax
                    .fromTo('body',.5, {css: {opacity: 0}}, {css: {opacity: 1}, ease: "easeInQuad", onComplete: function(){logoAnim.resume()}});


            var step2Anim = TweenMax
                    .to('.container--3d', 1, {rotationY: -90});


            // Issue on IE8 with vh unit
            voletAnim = new TimelineMax();
            voletAnim.append( [TweenMax.fromTo('.volet-1',1, {css: {height: '50vh'}}, {css: {height: '20vh'}, ease: "easeOutBounce"}),
                            TweenMax.fromTo('.volet-2',1, {css: {height: '50vh'}}, {css: {height: '13vh'}, ease: "easeOutBounce"})])
                    .pause();

            var step3Anim = TweenMax
                    .to('.step_3', 1, {top: 0});

            // Animation 3D ou non
            if(Modernizr.csstransforms3d){
                initScrollAnimations3D();
            } else {
                initScrollAnimations();
            }
            function initScrollAnimations3D(){
                jQuery('body').height(5000);

                var controller = $.superscrollorama({
                    triggerAtCenter: false
                });
                controller.addTween(1000, step2Anim, 0);
                controller.addTween(2000, voletAnim, 0);
                controller.addTween(3000, step3Anim, 0);
            }
            function initScrollAnimations(){
                var controller = $.superscrollorama({
                    triggerAtCenter: false
                });
                controller.addTween('.step_2', voletAnim, 0);
            }



            jQuery(document).on('keypress', function(){
                test();
            });
            function test(){
                console.log('test');
                voletAnim.play(0);
            }

        }(jQuery));
    </script>

</body>

</html>
